(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[449],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},1316:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(5155),r=s(2115),n=s(1847);let o=(0,n.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),l=(0,n.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var i=s(1433);let c="backtester.favoriteSymbols",d=["BTC","ETH","SOL","HYPE"];function m(e){let{value:t,onChange:s,availableSymbols:n}=e,[m,u]=(0,r.useState)(!1),[h,x]=(0,r.useState)(""),[p,b]=(0,r.useState)(d),f=(0,r.useRef)(null),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{function e(e){f.current&&!f.current.contains(e.target)&&(u(!1),x(""))}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{let e=window.localStorage.getItem(c);if(e)try{let t=JSON.parse(e);if(Array.isArray(t)){let e=Array.from(new Set(t.map(e=>"string"==typeof e?e.toUpperCase():"").filter(e=>e&&n.includes(e))));e.length>0&&b(e)}}catch(e){console.warn("Failed to parse favorite symbols from storage",e)}},[]),(0,r.useEffect)(()=>{b(e=>{let t=e.filter(e=>n.includes(e));return t.length===e.length&&t.every((t,s)=>t===e[s])?e:t})},[n]),(0,r.useEffect)(()=>{window.localStorage.setItem(c,JSON.stringify(p))},[p]);let v=e=>{let t=e.toUpperCase();n.includes(t)&&b(e=>e.includes(t)?e.filter(e=>e!==t):[t,...e])},y=n.filter(e=>e.toUpperCase().startsWith(h.toUpperCase())),j=p.filter(e=>y.includes(e)),w=y.filter(e=>!p.includes(e)),N=t&&p.includes(t.toUpperCase()),k=(e,r)=>(0,a.jsxs)("button",{type:"button",onClick:()=>{s(e),u(!1),x("")},className:(0,i.cn)("w-full px-3 py-2 text-left hover:bg-[#252525] transition-colors flex items-center gap-2",t===e&&"bg-[#2a2e39] text-primary"),children:[(0,a.jsx)("span",{className:"font-medium",children:e}),(0,a.jsx)("span",{className:"ml-auto"}),(0,a.jsx)("span",{role:"button",tabIndex:0,"aria-label":r?"Remove ".concat(e," from favorites"):"Add ".concat(e," to favorites"),className:"p-1 -mr-1 rounded transition-colors hover:bg-[#2a2e39]",onClick:t=>{t.preventDefault(),t.stopPropagation(),v(e)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),v(e))},children:(0,a.jsx)(o,{className:"w-3.5 h-3.5",stroke:r?"#FFB800":"#666",fill:r?"#FFB800":"transparent"})})]},e);return(0,a.jsxs)("div",{className:"relative",ref:f,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{u(!0),setTimeout(()=>{var e;null==(e=g.current)||e.focus()},0)},className:"w-full h-10 bg-[#1a1d24] border border-[#2a2e39] rounded-md text-white px-3 text-left focus:outline-none focus:border-[#375a7f] hover:bg-[#1f2229] transition-colors flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[t||"Select symbol...",t&&N&&(0,a.jsx)(o,{className:"w-3 h-3",stroke:"#FFB800",fill:"#FFB800"})]}),(0,a.jsx)(l,{className:"w-4 h-4 text-[#666]"})]}),m&&(0,a.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-[#1a1d24] border border-[#2a2e39] rounded-md shadow-lg max-h-[400px] flex flex-col z-50",children:[(0,a.jsx)("div",{className:"p-2 border-b border-[#2a2e39]",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[#666]"}),(0,a.jsx)("input",{ref:g,type:"text",value:h,onChange:e=>x(e.target.value),placeholder:"Search symbols...",className:"w-full h-8 bg-background border border-[#2a2e39] rounded text-white pl-8 pr-3 text-sm focus:outline-none focus:border-[#375a7f]"})]})}),(0,a.jsxs)("div",{className:"overflow-y-auto max-h-[350px]",children:[j.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"px-3 py-1.5 text-xs text-[#888] uppercase tracking-wider font-semibold bg-background sticky top-0",children:"Favorites"}),j.map(e=>k(e,!0))]}),w.length>0&&(0,a.jsxs)("div",{children:[j.length>0&&(0,a.jsx)("div",{className:"px-3 py-1.5 text-xs text-[#888] uppercase tracking-wider font-semibold bg-background sticky top-0 border-t border-[#2a2e39]",children:"All Symbols"}),w.map(e=>k(e,!1))]}),0===y.length&&(0,a.jsx)("div",{className:"px-3 py-4 text-center text-[#666] text-sm",children:"No symbols found"})]})]})]})}},1800:(e,t,s)=>{Promise.resolve().then(s.bind(s,8861))},7123:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(5155),r=s(63),n=s(1433);function o(e){let{view:t,onChange:s,className:r}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("inline-flex rounded-md border border-[#2a2e39] overflow-hidden",r),children:[(0,a.jsx)("button",{type:"button",onClick:()=>s("overview"),className:(0,n.cn)("px-2.5 py-1.5 text-xs font-medium transition-colors","overview"===t?"bg-[#2a2a2a] text-white":"bg-[#151515] text-[#cfd3dc] hover:bg-[#1b1b1b] border-r border-[#2a2e39]"),"aria-pressed":"overview"===t,children:"Overview"}),(0,a.jsx)("button",{type:"button",onClick:()=>s("by-coin"),className:(0,n.cn)("px-2.5 py-1.5 text-xs font-medium transition-colors","by-coin"===t?"bg-[#2a2a2a] text-white":"bg-[#151515] text-[#cfd3dc] hover:bg-[#1b1b1b]"),"aria-pressed":"by-coin"===t,children:"By Coin"})]})}function l(e){let{current:t,className:s}=e,n=(0,r.useRouter)();return(0,a.jsx)(o,{view:t,onChange:e=>{"overview"===e?n.push("/funding/historical"):n.push("/funding/history")},className:s})}},8861:(e,t,s)=>{"use strict";s.d(t,{default:()=>w});var a=s(5155),r=s(2115),n=s(63),o=s(2619),l=s.n(o),i=s(5368),c=s(7818),d=s(5239),m=s(2301),u=s(8518),h=s(4381),x=s(1316),p=s(8564),b=s(217),f=s(1433);let g={symbol:"BTC",series:{}},v=["BTC","ETH","SOL","HYPE","DOGE","XRP","ADA","AVAX","DOT","MATIC","LINK","UNI","ATOM","LTC","APT","ARB","OP","SUI","TIA","SEI"];function y(e){let{initialExchanges:t,initialSymbols:s,tabsSlot:o}=e,y=(0,n.useSearchParams)(),[j,w]=(0,r.useState)(s.length>0?s:v),[N,k]=(0,r.useState)(()=>y.get("symbol")||"BTC"),S=y.get("range")||"24h",[C,T]=(0,r.useState)(()=>y.get("start")||y.get("end")?"1d":({"8h":"1d","24h":"1d","2d":"7d","7d":"7d","14d":"14d","30d":"30d",custom:"1d"})[S]||"1d"),[A,E]=(0,r.useState)(()=>y.get("start")||void 0),[P,L]=(0,r.useState)(()=>y.get("end")||void 0),[O,R]=(0,r.useState)(()=>{let e=y.get("unit");return"bps"===e||"apy"===e?e:"bps"}),[_,B]=(0,r.useState)(()=>{let e=y.get("exchanges");return e?e.split(",").filter(Boolean):t.map(e=>e.name.split("_")[0])}),[U,F]=(0,r.useState)(!1),D=(0,r.useMemo)(()=>{if(A)return new Date(A+"T00:00:00Z").toISOString()},[A]),I=(0,r.useMemo)(()=>{if(P)return new Date(P+"T23:59:59Z").toISOString()},[P]),{start:M,end:H}=(0,r.useMemo)(()=>D&&I?{start:D,end:I}:(0,b.u)(C),[C,D,I]),{data:z,isLoading:V}=(0,c.Z)({symbol:N,exchanges:_,startDate:M,endDate:H,timeRange:D&&I?"custom":C}),X=z||g;(0,r.useEffect)(()=>{F(!0)},[]),(0,r.useEffect)(()=>{0===s.length&&fetch("/api/funding/metadata").then(e=>e.json()).then(e=>{e.symbols&&e.symbols.length>0&&w(e.symbols)}).catch(e=>{console.error("Failed to fetch symbols client-side:",e)})},[s.length]),(0,r.useEffect)(()=>{if(!U)return;let e=new URLSearchParams;"BTC"!==N&&e.set("symbol",N),"1d"!==C&&e.set("range",C),"bps"!==O&&e.set("unit",O),_.length>0&&_.length!==t.length&&e.set("exchanges",_.join(",")),A&&P&&(e.set("start",A),e.set("end",P));let s=e.toString(),a=s?"?".concat(s):window.location.pathname;window.history.replaceState({},"",a)},[N,C,O,_,A,P,U,t.length]);let Y=async()=>{try{let e=new URLSearchParams;e.set("symbol",N),A&&P?(e.set("start",A),e.set("end",P)):e.set("range",C),_.length>0&&_.length<t.length&&e.set("exchanges",_.join(","));let s="".concat(window.location.origin).concat(window.location.pathname,"?").concat(e.toString());await navigator.clipboard.writeText(s);let a=document.querySelector("[data-share-button]");if(a){let e=a.textContent;a.textContent="Link copied!",a.disabled=!0,setTimeout(()=>{a.textContent=e,a.disabled=!1},1500)}}catch(e){console.warn("Failed to copy link",e),alert("Could not copy link. You can copy from the address bar.")}};return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-[1700px]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-white mr-3",children:"Historical Funding Rates"}),(0,a.jsx)("span",{className:"hidden lg:inline text-sm text-gray-400",children:"Explore historical funding across exchanges. Use quick links below to visit exchanges."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"hidden md:block mr-2",children:o}),(0,a.jsx)("button",{onClick:()=>{if(!X||!X.series||0===Object.keys(X.series).length)return;let e=X.series,t=new Set;Object.values(e).forEach(e=>{Array.isArray(e)&&e.forEach(e=>t.add(e.t))});let s=Array.from(t).sort(),a="apy"===O?" (APY)":" (bps)",r=[["timestamp",...Object.keys(e).map(e=>e.replace("_1_perp","").toUpperCase()+a)].join(",")];s.forEach(t=>{let s=Object.keys(e).map(s=>{let a=e[s].find(e=>e.t===t);if(!a)return"";let r=a.y;return"apy"===O&&(r=Math.round(3*r*365/100)),String(r)});r.push([t,...s].join(","))});let n=new Blob(["\uFEFF"+r.join("\n")],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(n),l=document.createElement("a"),i=e=>isNaN(e.getTime())?"unknown":e.toISOString().replace(/[:]/g,"").replace(/\..*/,""),c="apy"===O?"apy":"bps",d="funding_".concat(N,"_").concat(c,"_").concat(C,"_").concat(i(new Date(M)),"_").concat(i(new Date(H)),".csv");l.href=o,l.download=d,document.body.appendChild(l),l.click(),document.body.removeChild(l),setTimeout(()=>URL.revokeObjectURL(o),1e3)},disabled:!X||0===Object.keys(X.series||{}).length,className:"px-3 py-1.5 text-xs font-medium rounded border border-[#444] text-[#ccc] hover:bg-[#333] disabled:opacity-50 disabled:cursor-not-allowed",children:"Export CSV"}),(0,a.jsx)("button",{onClick:Y,"data-share-button":!0,className:"px-3 py-1.5 text-xs font-medium rounded border border-[#444] text-[#ccc] hover:bg-[#333]",children:"Share this chart"})]})]}),(0,a.jsx)("div",{className:"mb-6 space-y-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"w-full sm:w-3/8 md:max-w-1/4",children:[(0,a.jsx)("label",{className:"block text-sm text-[#cfd3dc] mb-2 font-medium",children:"Token"}),(0,a.jsx)(x.A,{value:N,onChange:e=>{k(e)},availableSymbols:j})]}),(0,a.jsxs)("div",{className:"w-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("label",{className:"block text-sm text-[#cfd3dc]",children:"Time Range"}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-1.5",children:[(0,a.jsx)("button",{type:"button",onClick:()=>R("bps"),className:(0,f.cn)("px-2 py-0.5 text-[11px] leading-none font-medium rounded-md border transition-colors","bps"===O?"bg-[#2a2a2a] border-[#444] text-white":"bg-[#151515] border-[#2a2e39] text-[#cfd3dc] hover:border-[#374151]"),children:"BPS"}),(0,a.jsx)("button",{type:"button",onClick:()=>R("apy"),className:(0,f.cn)("px-2 py-0.5 text-[11px] leading-none font-medium rounded-md border transition-colors","apy"===O?"bg-[#2a2a2a] border-[#444] text-white":"bg-[#151515] border-[#2a2e39] text-[#cfd3dc] hover:border-[#374151]"),children:"APY"})]})]}),(0,a.jsx)(h.A,{value:C,onChange:e=>{T(e),E(void 0),L(void 0)},onCustomRangeChange:(e,t)=>{E(e),L(t)}})]}),(0,a.jsxs)("div",{className:"w-full sm:flex-1 md:w-auto md:ml-auto md:max-w-2/5",children:[(0,a.jsx)("label",{className:"block text-sm text-[#cfd3dc] mb-2",children:"Exchanges"}),(0,a.jsx)("div",{className:"bg-[#1e1e1e] border border-[#333] rounded-lg h-[42px] flex items-center transition-colors hover:bg-[#252525]",children:(0,a.jsx)(p.A,{exchanges:t,selectedExchanges:_,onSelectionChange:B})})]})]})}),N&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)(l(),{href:"/funding/history/".concat(N.toLowerCase()),className:"inline-flex items-center gap-1 text-primary hover:underline transition-all text-sm font-medium cursor-pointer",children:["View ",(0,u.Lb)(N).name," (",N,") detailed heatmap →"]})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"bg-[#161616] border border-[#2a2e39] rounded-lg shadow-sm mb-6",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"relative",style:{height:"520px",paddingTop:"10px"},children:[V&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/25 z-10",children:(0,a.jsx)(d.default,{src:"/loris.png",alt:"Loading",width:40,height:40,className:"w-10 h-10 animate-spin opacity-90",style:{filter:"drop-shadow(0 0 6px rgba(0,0,0,0.6))"}})}),(0,a.jsx)(i.A,{data:X,unit:O})]})}),(0,a.jsx)("div",{className:"px-4 pb-3",children:(0,a.jsx)("small",{className:"text-foreground/60",children:"Tip: click legend items to toggle exchanges."})})]}),(0,a.jsx)("div",{className:"mb-4 bg-background px-1 py-1.5 border border-[#2a2e39] rounded-lg",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2 overflow-x-auto px-1.5 py-1",children:_.map(e=>{let t=(0,m.J)(e),s="/images/exchanges/".concat(e.split("_")[0].toLowerCase(),".png"),r=(0,m.R)(e,N);return(0,a.jsxs)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 text-[#e6e6e6] bg-[#1a1d24] border border-[#2a2e39] rounded-lg px-2.5 py-2 text-xs font-medium transition-all hover:scale-105 hover:border-[#ff6a45] hover:shadow-[0_0_0_1px_#ff6a45_inset] hover:text-white shrink-0",children:[(0,a.jsx)(d.default,{src:s,alt:t,width:16,height:16,className:"w-4 h-4 object-contain",onError:e=>{e.target.style.display="none"}}),(0,a.jsx)("span",{children:t}),(0,a.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-3 h-3 ml-1.5 opacity-85",children:[(0,a.jsx)("path",{d:"M14 3h7v7",stroke:"#ff6a45",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M21 3l-9 9",stroke:"#ff6a45",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M5 12v7a2 2 0 0 0 2 2h7",stroke:"#ff6a45",strokeWidth:"2"})]})]},e)})})})]}),(0,a.jsxs)("div",{className:"mb-6 mt-8 pt-6 border-t border-[#2a2e39]",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Explore Historical Funding Rates by Token"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-x-2 gap-y-2 items-center text-sm",children:[["BTC","ETH","USDT","BNB","SOL","XRP","USDC","ADA","AVAX","DOGE","TRX","DOT","MATIC","LTC","SHIB","UNI","LINK","BCH","NEAR","APT"].map((e,t,s)=>{let r=(0,u.Lb)(e).name;return(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsxs)(l(),{href:"/funding/history/".concat(e.toLowerCase()),className:"text-primary hover:underline transition-all cursor-pointer",children:[r," (",e,")"]}),t<s.length-1&&(0,a.jsx)("span",{className:"text-foreground/40 mx-2",children:"|"})]},e)}),(0,a.jsx)("span",{className:"text-foreground/40 mx-2",children:"|"}),(0,a.jsx)(l(),{href:"/funding/history",className:"text-primary hover:underline transition-all font-medium cursor-pointer",children:"View All Tokens →"})]})]}),(0,a.jsx)("div",{className:"mb-6 text-sm text-foreground/60 leading-relaxed",children:(0,a.jsx)("p",{children:"This page visualizes historical funding rates for crypto perpetual futures across supported exchanges. Funding is the periodic payment exchanged between longs and shorts to anchor perp prices to spot. Positive funding means longs pay shorts; negative funding means shorts pay longs. Use the controls above to compare exchanges, analyze trends, and identify periods of extreme funding that may signal crowded positioning or carry opportunities."})})]})}var j=s(7123);function w(e){let{initialExchanges:t,initialSymbols:s}=e,n=(0,a.jsx)(j.default,{current:"overview"}),o=(0,r.useMemo)(()=>s,[s]);return(0,a.jsx)(y,{initialExchanges:t,initialSymbols:o,tabsSlot:n})}}},e=>{e.O(0,[647,586,619,909,239,805,64,756,720,930,441,255,358],()=>e(e.s=1800)),_N_E=e.O()}]);